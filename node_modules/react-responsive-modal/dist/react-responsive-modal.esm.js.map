{"version":3,"file":"react-responsive-modal.esm.js","sources":["../src/CloseIcon.tsx","../src/utils.ts","../src/lib/focusTrapJs.ts","../src/FocusTrap.tsx","../src/modalManager.ts","../src/useScrollLock.ts","../src/index.tsx"],"sourcesContent":["import React from 'react';\nimport cx from 'classnames';\n\ninterface CloseIconProps {\n  id?: string;\n  closeIcon?: React.ReactNode;\n  styles?: {\n    closeButton?: React.CSSProperties;\n    closeIcon?: React.CSSProperties;\n  };\n  classNames?: {\n    closeButton?: string;\n    closeIcon?: string;\n  };\n  classes: {\n    closeButton?: string;\n  };\n  onClick: () => void;\n}\n\nconst CloseIcon = ({\n  classes,\n  classNames,\n  styles,\n  id,\n  closeIcon,\n  onClick,\n}: CloseIconProps) => (\n  <button\n    id={id}\n    className={cx(classes.closeButton, classNames?.closeButton)}\n    style={styles?.closeButton}\n    onClick={onClick}\n    data-testid=\"close-button\"\n  >\n    {closeIcon ? (\n      closeIcon\n    ) : (\n      <svg\n        className={classNames?.closeIcon}\n        style={styles?.closeIcon}\n        width={28}\n        height={28}\n        viewBox=\"0 0 36 36\"\n        data-testid=\"close-icon\"\n      >\n        <path d=\"M28.5 9.62L26.38 7.5 18 15.88 9.62 7.5 7.5 9.62 15.88 18 7.5 26.38l2.12 2.12L18 20.12l8.38 8.38 2.12-2.12L20.12 18z\" />\n      </svg>\n    )}\n  </button>\n);\n\nexport default CloseIcon;\n","export const isBrowser = typeof window !== 'undefined';\n","// https://github.com/alexandrzavalii/focus-trap-js/blob/master/src/index.js v1.1.0\n\nexport const candidateSelectors = [\n  'input',\n  'select',\n  'textarea',\n  'a[href]',\n  'button',\n  '[tabindex]',\n  'audio[controls]',\n  'video[controls]',\n  '[contenteditable]:not([contenteditable=\"false\"])',\n];\n\nfunction isHidden(node: any) {\n  // offsetParent being null will allow detecting cases where an element is invisible or inside an invisible element,\n  // as long as the element does not use position: fixed. For them, their visibility has to be checked directly as well.\n  return (\n    node.offsetParent === null || getComputedStyle(node).visibility === 'hidden'\n  );\n}\n\nfunction getCheckedRadio(nodes: any, form: any) {\n  for (var i = 0; i < nodes.length; i++) {\n    if (nodes[i].checked && nodes[i].form === form) {\n      return nodes[i];\n    }\n  }\n}\n\nfunction isNotRadioOrTabbableRadio(node: any) {\n  if (node.tagName !== 'INPUT' || node.type !== 'radio' || !node.name) {\n    return true;\n  }\n  var radioScope = node.form || node.ownerDocument;\n  var radioSet = radioScope.querySelectorAll(\n    'input[type=\"radio\"][name=\"' + node.name + '\"]'\n  );\n  var checked = getCheckedRadio(radioSet, node.form);\n  return checked === node || (checked === undefined && radioSet[0] === node);\n}\n\nexport function getAllTabbingElements(parentElem: any) {\n  var currentActiveElement = document.activeElement;\n  var tabbableNodes = parentElem.querySelectorAll(candidateSelectors.join(','));\n  var onlyTabbable = [];\n  for (var i = 0; i < tabbableNodes.length; i++) {\n    var node = tabbableNodes[i];\n    if (\n      currentActiveElement === node ||\n      (!node.disabled &&\n        getTabindex(node) > -1 &&\n        !isHidden(node) &&\n        isNotRadioOrTabbableRadio(node))\n    ) {\n      onlyTabbable.push(node);\n    }\n  }\n  return onlyTabbable;\n}\n\nexport function tabTrappingKey(event: any, parentElem: any) {\n  // check if current event keyCode is tab\n  if (!event || event.key !== 'Tab') return;\n\n  if (!parentElem || !parentElem.contains) {\n    if (process && process.env.NODE_ENV === 'development') {\n      console.warn('focus-trap-js: parent element is not defined');\n    }\n    return false;\n  }\n\n  if (!parentElem.contains(event.target)) {\n    return false;\n  }\n\n  var allTabbingElements = getAllTabbingElements(parentElem);\n  var firstFocusableElement = allTabbingElements[0];\n  var lastFocusableElement = allTabbingElements[allTabbingElements.length - 1];\n\n  if (event.shiftKey && event.target === firstFocusableElement) {\n    lastFocusableElement.focus();\n    event.preventDefault();\n    return true;\n  } else if (!event.shiftKey && event.target === lastFocusableElement) {\n    firstFocusableElement.focus();\n    event.preventDefault();\n    return true;\n  }\n  return false;\n}\n\nfunction getTabindex(node: any) {\n  var tabindexAttr = parseInt(node.getAttribute('tabindex'), 10);\n\n  if (!isNaN(tabindexAttr)) return tabindexAttr;\n  // Browsers do not return tabIndex correctly for contentEditable nodes;\n  // so if they don't have a tabindex attribute specifically set, assume it's 0.\n\n  if (isContentEditable(node)) return 0;\n  return node.tabIndex;\n}\n\nfunction isContentEditable(node: any) {\n  return node.getAttribute('contentEditable');\n}\n","import { useEffect, useRef } from 'react';\nimport { isBrowser } from './utils';\nimport {\n  tabTrappingKey,\n  candidateSelectors,\n  getAllTabbingElements,\n} from './lib/focusTrapJs';\n\ninterface FocusTrapProps {\n  container?: React.RefObject<HTMLElement> | null;\n}\n\nexport const FocusTrap = ({ container }: FocusTrapProps) => {\n  const refLastFocus = useRef<HTMLElement | null>();\n  /**\n   * Handle focus lock on the modal\n   */\n  useEffect(() => {\n    const handleKeyEvent = (event: KeyboardEvent) => {\n      if (container?.current) {\n        tabTrappingKey(event, container.current);\n      }\n    };\n\n    if (isBrowser) {\n      document.addEventListener('keydown', handleKeyEvent);\n    }\n    // On mount we focus on the first focusable element in the modal if there is one\n    if (isBrowser && container?.current) {\n      const allTabbingElements = getAllTabbingElements(container.current);\n      if (allTabbingElements[0]) {\n        // First we save the last focused element\n        // only if it's a focusable element\n        if (\n          candidateSelectors.findIndex((selector) =>\n            document.activeElement?.matches(selector)\n          ) !== -1\n        ) {\n          refLastFocus.current = document.activeElement as HTMLElement;\n        }\n        allTabbingElements[0].focus();\n      }\n    }\n    return () => {\n      if (isBrowser) {\n        document.removeEventListener('keydown', handleKeyEvent);\n        // On unmount we restore the focus to the last focused element\n        refLastFocus.current?.focus();\n      }\n    };\n  }, [container]);\n\n  return null;\n};\n","import { Ref, useEffect } from 'react';\n\nlet modals: Ref<Element>[] = [];\n\n/**\n * Handle the order of the modals.\n * Inspired by the material-ui implementation.\n */\nexport const modalManager = {\n  /**\n   * Register a new modal\n   */\n  add: (newModal: Ref<Element>) => {\n    modals.push(newModal);\n  },\n\n  /**\n   * Remove a modal\n   */\n  remove: (oldModal: Ref<Element>) => {\n    modals = modals.filter((modal) => modal !== oldModal);\n  },\n\n  /**\n   * When multiple modals are rendered will return true if current modal is the last one\n   */\n  isTopModal: (modal: Ref<Element>) =>\n    !!modals.length && modals[modals.length - 1] === modal,\n};\n\nexport function useModalManager(ref: Ref<Element>, open: boolean) {\n  useEffect(() => {\n    if (open) {\n      modalManager.add(ref);\n    }\n    return () => {\n      modalManager.remove(ref);\n    };\n  }, [open, ref]);\n}\n","import { useEffect, useRef } from 'react';\nimport { disableBodyScroll, enableBodyScroll } from 'body-scroll-lock';\n\nexport const useScrollLock = (\n  refModal: React.RefObject<Element>,\n  open: boolean,\n  showPortal: boolean,\n  blockScroll: boolean\n) => {\n  const oldRef = useRef<Element | null>(null);\n\n  useEffect(() => {\n    if (open && refModal.current && blockScroll) {\n      oldRef.current = refModal.current;\n      disableBodyScroll(refModal.current);\n    }\n    return () => {\n      if (oldRef.current) {\n        enableBodyScroll(oldRef.current);\n        oldRef.current = null;\n      }\n    };\n  }, [open, showPortal, refModal]);\n};\n","import React, { useEffect, useState, useRef } from 'react';\nimport ReactDom from 'react-dom';\nimport cx from 'classnames';\nimport CloseIcon from './CloseIcon';\nimport { FocusTrap } from './FocusTrap';\nimport { modalManager, useModalManager } from './modalManager';\nimport { useScrollLock } from './useScrollLock';\nimport { isBrowser } from './utils';\n\nconst classes = {\n  root: 'react-responsive-modal-root',\n  overlay: 'react-responsive-modal-overlay',\n  overlayAnimationIn: 'react-responsive-modal-overlay-in',\n  overlayAnimationOut: 'react-responsive-modal-overlay-out',\n  modalContainer: 'react-responsive-modal-container',\n  modalContainerCenter: 'react-responsive-modal-containerCenter',\n  modal: 'react-responsive-modal-modal',\n  modalAnimationIn: 'react-responsive-modal-modal-in',\n  modalAnimationOut: 'react-responsive-modal-modal-out',\n  closeButton: 'react-responsive-modal-closeButton',\n};\n\nexport interface ModalProps {\n  /**\n   * Control if the modal is open or not.\n   */\n  open: boolean;\n  /**\n   * Should the dialog be centered.\n   *\n   * Default to false.\n   */\n  center?: boolean;\n  /**\n   * Is the modal closable when user press esc key.\n   *\n   * Default to true.\n   */\n  closeOnEsc?: boolean;\n  /**\n   * Is the modal closable when user click on overlay.\n   *\n   * Default to true.\n   */\n  closeOnOverlayClick?: boolean;\n  /**\n   * Whether to block scrolling when dialog is open.\n   *\n   * Default to true.\n   */\n  blockScroll?: boolean;\n  /**\n   * Show the close icon.\n   *\n   * Default to true.\n   */\n  showCloseIcon?: boolean;\n  /**\n   * id attribute for the close icon button.\n   */\n  closeIconId?: string;\n  /**\n   * Custom icon to render (svg, img, etc...).\n   */\n  closeIcon?: React.ReactNode;\n  /**\n   * When the modal is open, trap focus within it.\n   *\n   * Default to true.\n   */\n  focusTrapped?: boolean;\n  /**\n   * You can specify a container prop which should be of type `Element`.\n   * The portal will be rendered inside that element.\n   * The default behavior will create a div node and render it at the at the end of document.body.\n   */\n  container?: Element | null;\n  /**\n   * An object containing classNames to style the modal.\n   */\n  classNames?: {\n    root?: string;\n    overlay?: string;\n    overlayAnimationIn?: string;\n    overlayAnimationOut?: string;\n    modalContainer?: string;\n    modal?: string;\n    modalAnimationIn?: string;\n    modalAnimationOut?: string;\n    closeButton?: string;\n    closeIcon?: string;\n  };\n  /**\n   * An object containing the styles objects to style the modal.\n   */\n  styles?: {\n    root?: React.CSSProperties;\n    overlay?: React.CSSProperties;\n    modalContainer?: React.CSSProperties;\n    modal?: React.CSSProperties;\n    closeButton?: React.CSSProperties;\n    closeIcon?: React.CSSProperties;\n  };\n  /**\n   * Animation duration in milliseconds.\n   *\n   * Default to 500.\n   */\n  animationDuration?: number;\n  /**\n   * ARIA role for modal\n   *\n   * Default to 'dialog'.\n   */\n  role?: string;\n  /**\n   * ARIA label for modal\n   */\n  ariaLabelledby?: string;\n  /**\n   * ARIA description for modal\n   */\n  ariaDescribedby?: string;\n  /**\n   * id attribute for modal\n   */\n  modalId?: string;\n  /**\n   * Callback fired when the Modal is requested to be closed by a click on the overlay or when user press esc key.\n   */\n  onClose: () => void;\n  /**\n   * Callback fired when the escape key is pressed.\n   */\n  onEscKeyDown?: (event: KeyboardEvent) => void;\n  /**\n   * Callback fired when the overlay is clicked.\n   */\n  onOverlayClick?: (\n    event: React.MouseEvent<HTMLDivElement, MouseEvent>\n  ) => void;\n  /**\n   * Callback fired when the Modal has exited and the animation is finished.\n   */\n  onAnimationEnd?: () => void;\n  children?: React.ReactNode;\n}\n\nexport const Modal = ({\n  open,\n  center,\n  blockScroll = true,\n  closeOnEsc = true,\n  closeOnOverlayClick = true,\n  container,\n  showCloseIcon = true,\n  closeIconId,\n  closeIcon,\n  focusTrapped = true,\n  animationDuration = 300,\n  classNames,\n  styles,\n  role = 'dialog',\n  ariaDescribedby,\n  ariaLabelledby,\n  modalId,\n  onClose,\n  onEscKeyDown,\n  onOverlayClick,\n  onAnimationEnd,\n  children,\n}: ModalProps) => {\n  const refModal = useRef<HTMLDivElement>(null);\n  const refShouldClose = useRef<boolean | null>(null);\n  const refContainer = useRef<HTMLDivElement | null>(null);\n  // Lazily create the ref instance\n  // https://reactjs.org/docs/hooks-faq.html#how-to-create-expensive-objects-lazily\n  if (refContainer.current === null && isBrowser) {\n    refContainer.current = document.createElement('div');\n  }\n\n  // The value should be false for srr, that way when the component is hydrated client side,\n  // it will match the server rendered content\n  const [showPortal, setShowPortal] = useState(false);\n\n  // Hook used to manage multiple modals opened at the same time\n  useModalManager(refModal, open);\n\n  // Hook used to manage the scroll\n  useScrollLock(refModal, open, showPortal, blockScroll);\n\n  const handleOpen = () => {\n    if (\n      refContainer.current &&\n      !container &&\n      !document.body.contains(refContainer.current)\n    ) {\n      document.body.appendChild(refContainer.current);\n    }\n\n    document.addEventListener('keydown', handleKeydown);\n  };\n\n  const handleClose = () => {\n    if (\n      refContainer.current &&\n      !container &&\n      document.body.contains(refContainer.current)\n    ) {\n      document.body.removeChild(refContainer.current);\n    }\n    document.removeEventListener('keydown', handleKeydown);\n  };\n\n  const handleKeydown = (event: KeyboardEvent) => {\n    // Only the last modal need to be escaped when pressing the esc key\n    if (event.keyCode !== 27 || !modalManager.isTopModal(refModal)) {\n      return;\n    }\n\n    onEscKeyDown?.(event);\n\n    if (closeOnEsc) {\n      onClose();\n    }\n  };\n\n  useEffect(() => {\n    return () => {\n      if (showPortal) {\n        // When the modal is closed or removed directly, cleanup the listeners\n        handleClose();\n      }\n    };\n  }, [showPortal]);\n\n  useEffect(() => {\n    // If the open prop is changing, we need to open the modal\n    // This is also called on the first render if the open prop is true when the modal is created\n    if (open && !showPortal) {\n      setShowPortal(true);\n      handleOpen();\n    }\n  }, [open]);\n\n  const handleClickOverlay = (\n    event: React.MouseEvent<HTMLDivElement, MouseEvent>\n  ) => {\n    if (refShouldClose.current === null) {\n      refShouldClose.current = true;\n    }\n\n    if (!refShouldClose.current) {\n      refShouldClose.current = null;\n      return;\n    }\n\n    onOverlayClick?.(event);\n\n    if (closeOnOverlayClick) {\n      onClose();\n    }\n\n    refShouldClose.current = null;\n  };\n\n  const handleModalEvent = () => {\n    refShouldClose.current = false;\n  };\n\n  const handleAnimationEnd = () => {\n    if (!open) {\n      setShowPortal(false);\n    }\n\n    onAnimationEnd?.();\n  };\n\n  const containerModal = container || refContainer.current;\n\n  const overlayAnimation = open\n    ? classNames?.overlayAnimationIn ?? classes.overlayAnimationIn\n    : classNames?.overlayAnimationOut ?? classes.overlayAnimationOut;\n\n  const modalAnimation = open\n    ? classNames?.modalAnimationIn ?? classes.modalAnimationIn\n    : classNames?.modalAnimationOut ?? classes.modalAnimationOut;\n\n  return showPortal && containerModal\n    ? ReactDom.createPortal(\n        <div\n          className={cx(classes.root, classNames?.root)}\n          style={styles?.root}\n          data-testid=\"root\"\n        >\n          <div\n            className={cx(classes.overlay, classNames?.overlay)}\n            data-testid=\"overlay\"\n            aria-hidden={true}\n            style={{\n              animation: `${overlayAnimation} ${animationDuration}ms`,\n              ...styles?.overlay,\n            }}\n          />\n          <div\n            ref={refModal}\n            className={cx(\n              classes.modalContainer,\n              center && classes.modalContainerCenter,\n              classNames?.modalContainer\n            )}\n            style={styles?.modalContainer}\n            data-testid=\"modal-container\"\n            onClick={handleClickOverlay}\n          >\n            <div\n              className={cx(classes.modal, classNames?.modal)}\n              style={{\n                animation: `${modalAnimation} ${animationDuration}ms`,\n                ...styles?.modal,\n              }}\n              onMouseDown={handleModalEvent}\n              onMouseUp={handleModalEvent}\n              onClick={handleModalEvent}\n              onAnimationEnd={handleAnimationEnd}\n              id={modalId}\n              role={role}\n              aria-modal=\"true\"\n              aria-labelledby={ariaLabelledby}\n              aria-describedby={ariaDescribedby}\n              data-testid=\"modal\"\n            >\n              {focusTrapped && <FocusTrap container={refModal} />}\n              {children}\n              {showCloseIcon && (\n                <CloseIcon\n                  classes={classes}\n                  classNames={classNames}\n                  styles={styles}\n                  closeIcon={closeIcon}\n                  onClick={onClose}\n                  id={closeIconId}\n                />\n              )}\n            </div>\n          </div>\n        </div>,\n        containerModal\n      )\n    : null;\n};\n\nexport default Modal;\n"],"names":["CloseIcon","classes","classNames","styles","id","closeIcon","onClick","React","className","cx","closeButton","style","width","height","viewBox","d","isBrowser","window","candidateSelectors","isHidden","node","offsetParent","getComputedStyle","visibility","getCheckedRadio","nodes","form","i","length","checked","isNotRadioOrTabbableRadio","tagName","type","name","radioScope","ownerDocument","radioSet","querySelectorAll","undefined","getAllTabbingElements","parentElem","currentActiveElement","document","activeElement","tabbableNodes","join","onlyTabbable","disabled","getTabindex","push","tabTrappingKey","event","key","contains","process","env","NODE_ENV","console","warn","target","allTabbingElements","firstFocusableElement","lastFocusableElement","shiftKey","focus","preventDefault","tabindexAttr","parseInt","getAttribute","isNaN","isContentEditable","tabIndex","FocusTrap","container","refLastFocus","useRef","useEffect","handleKeyEvent","current","addEventListener","findIndex","selector","matches","removeEventListener","modals","modalManager","add","newModal","remove","oldModal","filter","modal","isTopModal","useModalManager","ref","open","useScrollLock","refModal","showPortal","blockScroll","oldRef","disableBodyScroll","enableBodyScroll","root","overlay","overlayAnimationIn","overlayAnimationOut","modalContainer","modalContainerCenter","modalAnimationIn","modalAnimationOut","Modal","center","closeOnEsc","closeOnOverlayClick","showCloseIcon","closeIconId","focusTrapped","animationDuration","role","ariaDescribedby","ariaLabelledby","modalId","onClose","onEscKeyDown","onOverlayClick","onAnimationEnd","children","refShouldClose","refContainer","createElement","useState","setShowPortal","handleOpen","body","appendChild","handleKeydown","handleClose","removeChild","keyCode","handleClickOverlay","handleModalEvent","handleAnimationEnd","containerModal","overlayAnimation","modalAnimation","ReactDom","createPortal","animation","onMouseDown","onMouseUp"],"mappings":"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"}